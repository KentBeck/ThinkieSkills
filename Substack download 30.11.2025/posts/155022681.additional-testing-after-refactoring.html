<p>Should you write more tests after refactoring? Following up <span class="mention-wrap" data-attrs="{&quot;name&quot;:&quot;Jeff Grigg&quot;,&quot;id&quot;:26181199,&quot;type&quot;:&quot;user&quot;,&quot;url&quot;:null,&quot;photo_url&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/1c0cb06d-d456-4cc1-a9f1-823bfdad6de3_144x144.png&quot;,&quot;uuid&quot;:&quot;47b92789-ed22-4478-873e-bedf90dea726&quot;}" data-component-name="MentionToDOM"></span>’s observation:</p><div class="captioned-image-container"><figure><a class="image-link image2" target="_blank" href="https://tidyfirst.substack.com/p/canon-tdd/comment/86734868" data-component-name="Image2ToDOM"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!DrX-!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffa911713-8b90-46d2-b478-f9ebc7954db9_752x151.png 424w, https://substackcdn.com/image/fetch/$s_!DrX-!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffa911713-8b90-46d2-b478-f9ebc7954db9_752x151.png 848w, https://substackcdn.com/image/fetch/$s_!DrX-!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffa911713-8b90-46d2-b478-f9ebc7954db9_752x151.png 1272w, https://substackcdn.com/image/fetch/$s_!DrX-!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffa911713-8b90-46d2-b478-f9ebc7954db9_752x151.png 1456w" sizes="100vw"><img src="https://substack-post-media.s3.amazonaws.com/public/images/fa911713-8b90-46d2-b478-f9ebc7954db9_752x151.png" width="752" height="151" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/fa911713-8b90-46d2-b478-f9ebc7954db9_752x151.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:151,&quot;width&quot;:752,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:27646,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:&quot;https://tidyfirst.substack.com/p/canon-tdd/comment/86734868&quot;,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:true,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" class="sizing-normal" alt="" srcset="https://substackcdn.com/image/fetch/$s_!DrX-!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffa911713-8b90-46d2-b478-f9ebc7954db9_752x151.png 424w, https://substackcdn.com/image/fetch/$s_!DrX-!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffa911713-8b90-46d2-b478-f9ebc7954db9_752x151.png 848w, https://substackcdn.com/image/fetch/$s_!DrX-!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffa911713-8b90-46d2-b478-f9ebc7954db9_752x151.png 1272w, https://substackcdn.com/image/fetch/$s_!DrX-!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffa911713-8b90-46d2-b478-f9ebc7954db9_752x151.png 1456w" sizes="100vw" fetchpriority="high"></picture><div></div></div></a></figure></div><p>Yes and no. Yes, in the sense that I’m about to describe. No, in the sense that you should have the same level of confidence in your tests (the “predictive” property from https://www.testdesiderata.com) as you had before because <em>of course</em> you’ve been careful not to change any behavior.</p><p>But you probably have an opportunity to improve your tests in some cases.</p><div><hr></div><p><em>Thanks to today’s sponsor, me!</em></p><p>My friend Flee dubbed me the Rick Rubin of software development, a moniker I wear proudly. Individuals &amp; teams seem to do better around me, even if you can’t see how I’m having that effect. Consider engaging me for an internal talk or for high-stakes consulting. Difficult situations preferred.</p><div class="directMessage button" data-attrs="{&quot;userId&quot;:24333739,&quot;userName&quot;:&quot;Kent Beck&quot;,&quot;canDm&quot;:null,&quot;dmUpgradeOptions&quot;:null,&quot;isEditorNode&quot;:true}" data-component-name="DirectMessageToDOM"></div><p>Also, this space is for rent. If you want to get your message out to a hundred thousand of the best geeks on the planet, contact me about sponsorships.</p><div><hr></div><h2>Differentiation</h2><p>One common form of design change is to take a big thing &amp; break it into parts. From Christopher Alexander’s The Timeless Way of Building:</p><blockquote><p>Within this process, every individual act of building is a process in which space gets differentiated. It is not a process of addition, in which preformed parts are combined to create a whole, but a process of unfolding, like the evolution of an embryo, in which the whole precedes the parts, and actually gives birth to them, by splitting.</p></blockquote><div class="captioned-image-container"><figure><a class="image-link image2 is-viewable-img" target="_blank" href="https://substackcdn.com/image/fetch/$s_!5HPm!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe52dba48-29ae-4ad8-8757-773bdff923ca_1120x614.png" data-component-name="Image2ToDOM"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!5HPm!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe52dba48-29ae-4ad8-8757-773bdff923ca_1120x614.png 424w, https://substackcdn.com/image/fetch/$s_!5HPm!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe52dba48-29ae-4ad8-8757-773bdff923ca_1120x614.png 848w, https://substackcdn.com/image/fetch/$s_!5HPm!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe52dba48-29ae-4ad8-8757-773bdff923ca_1120x614.png 1272w, https://substackcdn.com/image/fetch/$s_!5HPm!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe52dba48-29ae-4ad8-8757-773bdff923ca_1120x614.png 1456w" sizes="100vw"><img src="https://substack-post-media.s3.amazonaws.com/public/images/e52dba48-29ae-4ad8-8757-773bdff923ca_1120x614.png" width="1120" height="614" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/e52dba48-29ae-4ad8-8757-773bdff923ca_1120x614.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:614,&quot;width&quot;:1120,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:1962602,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" class="sizing-normal" alt="" srcset="https://substackcdn.com/image/fetch/$s_!5HPm!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe52dba48-29ae-4ad8-8757-773bdff923ca_1120x614.png 424w, https://substackcdn.com/image/fetch/$s_!5HPm!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe52dba48-29ae-4ad8-8757-773bdff923ca_1120x614.png 848w, https://substackcdn.com/image/fetch/$s_!5HPm!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe52dba48-29ae-4ad8-8757-773bdff923ca_1120x614.png 1272w, https://substackcdn.com/image/fetch/$s_!5HPm!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe52dba48-29ae-4ad8-8757-773bdff923ca_1120x614.png 1456w" sizes="100vw" loading="lazy"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></button><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2 lucide-maximize-2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></button></div></div></div></a></figure></div><p>Say we’ve done this. We had a big element. We’ve split it into parts. The tests remain. We are just as confident of the behavior as we’ve ever been. What happens next is what I think Jeff is getting at.</p><h2>Unit-izing Tests</h2><p>Now that we have these smaller sub-elements, presumably with narrower APIs, we can, if we so choose, write smaller tests for the sub-elements:</p><div class="captioned-image-container"><figure><a class="image-link image2 is-viewable-img" target="_blank" href="https://substackcdn.com/image/fetch/$s_!E4sT!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff8ef35c0-3fa8-43b8-86f4-e84a5f4e406a_1761x614.png" data-component-name="Image2ToDOM"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!E4sT!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff8ef35c0-3fa8-43b8-86f4-e84a5f4e406a_1761x614.png 424w, https://substackcdn.com/image/fetch/$s_!E4sT!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff8ef35c0-3fa8-43b8-86f4-e84a5f4e406a_1761x614.png 848w, https://substackcdn.com/image/fetch/$s_!E4sT!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff8ef35c0-3fa8-43b8-86f4-e84a5f4e406a_1761x614.png 1272w, https://substackcdn.com/image/fetch/$s_!E4sT!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff8ef35c0-3fa8-43b8-86f4-e84a5f4e406a_1761x614.png 1456w" sizes="100vw"><img src="https://substack-post-media.s3.amazonaws.com/public/images/f8ef35c0-3fa8-43b8-86f4-e84a5f4e406a_1761x614.png" width="1456" height="508" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/f8ef35c0-3fa8-43b8-86f4-e84a5f4e406a_1761x614.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:508,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:3272120,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" class="sizing-normal" alt="" srcset="https://substackcdn.com/image/fetch/$s_!E4sT!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff8ef35c0-3fa8-43b8-86f4-e84a5f4e406a_1761x614.png 424w, https://substackcdn.com/image/fetch/$s_!E4sT!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff8ef35c0-3fa8-43b8-86f4-e84a5f4e406a_1761x614.png 848w, https://substackcdn.com/image/fetch/$s_!E4sT!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff8ef35c0-3fa8-43b8-86f4-e84a5f4e406a_1761x614.png 1272w, https://substackcdn.com/image/fetch/$s_!E4sT!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff8ef35c0-3fa8-43b8-86f4-e84a5f4e406a_1761x614.png 1456w" sizes="100vw" loading="lazy"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></button><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2 lucide-maximize-2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></button></div></div></div></a></figure></div><p>This is particularly important if:</p><ul><li><p>We want to use those sub-elements elsewhere. Extracted sub-elements tend to be reusable through some mysterious process of the universe I do not yet understand, only observe.</p></li><li><p>We want to change those sub-elements. We need the caller’s view of the sub-element to be fixed.</p></li></ul><p>This gives us a question about the timing of writing those smaller-scale tests. Do we do it, as Jeff seems to be suggesting, as part of the refactoring process? Or do we write the tests as a “tidy first”, when we’re about to reuse or modify them?</p><h2>Redundancy</h2><p>Some folks would say not to bother writing the sub-element tests. I disagree. I like the pressure that sub-element level tests put on me to clarify &amp; improve the design.</p><p>Once we’ve written those tests, we are redundantly double checking the behavior of the system. Here’s where we have another genuine decision to make. Some people would say that we should never remove the element-level tests because OMG we don’t want to lose any coverage. Again, I disagree.</p><div class="captioned-image-container"><figure><a class="image-link image2 is-viewable-img" target="_blank" href="https://substackcdn.com/image/fetch/$s_!IZHX!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1425b4f-8020-4463-a056-3ee6d1c92d61_2298x614.png" data-component-name="Image2ToDOM"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!IZHX!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1425b4f-8020-4463-a056-3ee6d1c92d61_2298x614.png 424w, https://substackcdn.com/image/fetch/$s_!IZHX!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1425b4f-8020-4463-a056-3ee6d1c92d61_2298x614.png 848w, https://substackcdn.com/image/fetch/$s_!IZHX!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1425b4f-8020-4463-a056-3ee6d1c92d61_2298x614.png 1272w, https://substackcdn.com/image/fetch/$s_!IZHX!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1425b4f-8020-4463-a056-3ee6d1c92d61_2298x614.png 1456w" sizes="100vw"><img src="https://substack-post-media.s3.amazonaws.com/public/images/f1425b4f-8020-4463-a056-3ee6d1c92d61_2298x614.png" width="1456" height="389" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/f1425b4f-8020-4463-a056-3ee6d1c92d61_2298x614.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:389,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:4213131,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" class="sizing-normal" alt="" srcset="https://substackcdn.com/image/fetch/$s_!IZHX!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1425b4f-8020-4463-a056-3ee6d1c92d61_2298x614.png 424w, https://substackcdn.com/image/fetch/$s_!IZHX!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1425b4f-8020-4463-a056-3ee6d1c92d61_2298x614.png 848w, https://substackcdn.com/image/fetch/$s_!IZHX!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1425b4f-8020-4463-a056-3ee6d1c92d61_2298x614.png 1272w, https://substackcdn.com/image/fetch/$s_!IZHX!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1425b4f-8020-4463-a056-3ee6d1c92d61_2298x614.png 1456w" sizes="100vw" loading="lazy"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></button><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2 lucide-maximize-2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></button></div></div></div></a></figure></div><p>I want the fewest possible system-level tests to give me the desired confidence (again, that “predictive” property). System-level tests tend to be slow to run, which incentivizes me to work in larger steps. I don’t need any more incentive to lengthen my feedback loops.</p><h2>The Dilemma</h2><p>This topic produced more discussion than I expected, and more polarized:</p><ul><li><p>Of course you delete redundant tests</p></li><li><p>Of course you never delete tests.</p></li></ul><p>Reduced to it’s simplest form, imagine we have 2 system-level tests, S1 &amp; S2, &amp; one component-level test C1. We conclude through analysis that if C1 fails then S1 fails because that part of the system calls the component. Also if S2 fails then S1 fails because the system is wired together wrong. If we assume C1 &amp; S2 pass, then S1 is completely redundant. Its pass or failure creates no new feedback for us.</p><p>In this perfect scenario, what do you do with S1? Leave it around consuming resources (maintenance, power consumption, delay seeing test results)? Or delete it? That’s the question.</p><p>A more concrete example one commenter brought up. Suppose we have a bunch of system-level tests checking for a bunch of error conditions. Now we extract components &amp; add tests ensuring that the components throw exceptions under those same conditions. I would tend to leave one of the system-level tests around to ensure that if an exception is thrown then it is handled correctly, but I’d delete the other, now redundant, system-level tests.</p><h2>Conclusion</h2><p>So, yes &amp; no, Jeff. Yes, you have an opportunity to write new tests after refactoring. No, the timing is up for grabs. Do you write the tests as a tidy after or a tidy first for your next change?</p><blockquote><p>Upon re-reading Jeff’s comment I missed his point. The dilemma posed here is still valid. His use of “refactoring” suggests he may have been speaking ironically. Usually my reflexes are fast enough to catch irony as it goes whizzing over my head. Not always.</p></blockquote>