<blockquote><p>Originally published January 2010</p></blockquote><div class="captioned-image-container"><figure><a class="image-link image2" target="_blank" href="https://substackcdn.com/image/fetch/$s_!Iowy!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdc179a8e-0bd3-4136-8bdf-139e561809b4_300x225.jpeg" data-component-name="Image2ToDOM"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!Iowy!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdc179a8e-0bd3-4136-8bdf-139e561809b4_300x225.jpeg 424w, https://substackcdn.com/image/fetch/$s_!Iowy!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdc179a8e-0bd3-4136-8bdf-139e561809b4_300x225.jpeg 848w, https://substackcdn.com/image/fetch/$s_!Iowy!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdc179a8e-0bd3-4136-8bdf-139e561809b4_300x225.jpeg 1272w, https://substackcdn.com/image/fetch/$s_!Iowy!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdc179a8e-0bd3-4136-8bdf-139e561809b4_300x225.jpeg 1456w" sizes="100vw"><img src="https://substack-post-media.s3.amazonaws.com/public/images/dc179a8e-0bd3-4136-8bdf-139e561809b4_300x225.jpeg" width="300" height="225" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/dc179a8e-0bd3-4136-8bdf-139e561809b4_300x225.jpeg&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:225,&quot;width&quot;:300,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:&quot;&quot;,&quot;title&quot;:&quot;napkin&quot;,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:true,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" class="sizing-normal" alt="" title="napkin" srcset="https://substackcdn.com/image/fetch/$s_!Iowy!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdc179a8e-0bd3-4136-8bdf-139e561809b4_300x225.jpeg 424w, https://substackcdn.com/image/fetch/$s_!Iowy!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdc179a8e-0bd3-4136-8bdf-139e561809b4_300x225.jpeg 848w, https://substackcdn.com/image/fetch/$s_!Iowy!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdc179a8e-0bd3-4136-8bdf-139e561809b4_300x225.jpeg 1272w, https://substackcdn.com/image/fetch/$s_!Iowy!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdc179a8e-0bd3-4136-8bdf-139e561809b4_300x225.jpeg 1456w" sizes="100vw" fetchpriority="high"></picture><div></div></div></a></figure></div><p>The other night I was having drinks in the Tower Bar of the Hotel Hafen in Hamburg (highly recommend for the view if not the service) with Henning Wolf and Arne Roock of <a href="https://web.archive.org/web/20140827235616/http://www.it-agile.de/">it-agile</a> when I casually mentioned that test-driven development was kanban for code. Arne teaches kanban but the connection wasn’t obvious to him, so I sketched my idea (see napkin above). He seemed to understand (he kept nodding, anyway), but I thought it prudent to follow up with a post to make sure I’d thought the whole thing through. Arne, this one’s for you.</p><h2>Kanban</h2><p>The goal of kanban is to increase the value of a production process. Kanban increases the feedback in production by limiting the amount of work in progress at any one time.&nbsp;Without the “safety” of inventory, troublesome process steps and connections between steps have nowhere to hide.&nbsp;With better feedback, the steps can be optimized (or eliminated) and their connections improved. The result is higher throughput and lower latency and variance.</p><p>Kanban works by only producing on the basis of demonstrated need. While one finished product is being assembled, upstream steps are producing the parts for the next finished product, timed to arrive just as they are about to be used. When a kanban system is humming, it produces a steady stream of finished products with a short gap between the receipt of an order and its fulfillment. When it isn’t humming, the source of the discord is likely to be clear.</p><h2>Test-driven Development</h2><p>Test-driven development (TDD) is an alternative programming workflow where features are divided into a series of automated tests. The tests are chosen so that satisfying the spirit of all the tests implies that the feature as a whole works correctly. The cycle goes like this:</p><ol><li><p>Write the next test (while several tests may be outlined, only one is written at a time)</p></li><li><p>In pessimistic languages, add enough stubs so the test compiles. It should fail when run.</p></li><li><p>Refactor, if necessary, to prepare for the implementation.</p></li><li><p>Change the logic of the system so the test passes.</p></li><li><p>Refactor to eliminate duplication and other excess complexity</p></li></ol><p>Repeat until no more of the tests implied by the feature would fail. Then the feature is complete.</p><h2>The Analogy</h2><p>If TDD is kanban for code:</p><ul><li><p>What is the product?</p></li><li><p>What is the kanban card?</p></li><li><p>What are the production steps?</p></li><li><p>How does demand flow backward and products flow forward?</p></li><li><p>What are the feedback loops?</p></li></ul><p>The product of software development is two-fold:</p><ul><li><p>The behavior of the system</p></li><li><p>The options for extending and modifying that behavior in the future</p></li></ul><p>As difficult as it can be to precisely specify and validate the behavior of the system, it is even harder to measure a system’s option value. Finding the right balance between these two goals is one of the big challenges of development, especially as different phases of the business cycle require<a href="https://web.archive.org/web/20140827235616/http://www.threeriversinstitute.org/blog/?p=251"> different proportions</a>. I’ll describe in a moment how TDD addresses this balance, both in theory and in practice.</p><p>The tests are the kanban cards in this system. Each one is a request for a change of behavior. “Please change the system so if the customer is a smoker the premium is 12% higher”. This will require changes to the logic of the system. It may also require changes to the structure of the system so the change to the logic is easier to make correctly and efficiently.</p><p>The post-success refactoring commonly emphasized in descriptions of TDD isn’t explicitly called for by the tests. It is work done for future benefit. If the future happens to be the next test and implementing it is easy because of cleanup done after the last test was satisfied, then the payoff is immediate. From the kanban perspective, though, post-success refactoring is over-production, the worst of the <a href="https://web.archive.org/web/20140827235616/http://www.google.com/url?url=http://en.wikipedia.org/wiki/Muda_(Japanese_term)%23The_Seven_wastes&amp;rct=j&amp;q=seven+wastes&amp;usg=AFQjCNFRCncXYX_yGaCQzxGLbY7_tz9TNg&amp;sa=X&amp;ei=-o3ZTLq6CYn0tgPC0dGICA&amp;ved=0CCcQygQ">seven wastes</a> of the Toyota Production System. Still, most TDDers, myself included, clean up after a test is passing as a matter of habit.</p><blockquote><p>Editor: Tidy First? goes over this in detail, but you probably already know that.</p></blockquote><p>The <em>behavior and options are the product</em>, the <em>test is the kanban card</em>, so the <em>changes to the logic and the changes to the structure of the system are the production steps</em>  In TDD, these changes are not begun until a test is failing. The changes flow forward into the product, as demonstrated by the passing test, and the lack of collateral damage is demonstrated when all previous tests also pass.</p><p>Feedback loops fuel kanban. In TDD, the programmer gets feedback in seconds about whether the logic implied by the test is the logic he writes. He also gets feedback about whether the design supports the logic changes based on how hard or easy those changes are to get right.</p><h2>Conclusion</h2><p>This isn’t the whole story of development. Post-success refactoring doesn’t fit into this picture but is a common practice. Is this just because of our still-evolving understanding of TDD, or is it more like the preventative maintenance needed to keep kanban systems running smoothly? Should some or all of it be deferred until immediately before it is needed? What about other valuable software development activities like automation, tool building, and exploration?</p><p>We could also pull back and look at development at a larger scale and see the features as kanban cards, each one “pulling” a collection of tests into the system, triggering coding. From even further back, a process like <a href="https://web.archive.org/web/20140827235616/http://www.amazon.com/gp/product/0982743602?ie=UTF8&amp;tag=threriveinst-20&amp;linkCode=as2&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0982743602">Customer Development</a> can be seen as “pulling” demand for features.</p><p>In any case, TDD is kanban for code:</p><ul><li><p>Product = behavior and options</p></li><li><p>Kanban card = test</p></li><li><p>Production step = coding and refactoring</p></li><li><p>Feedback = effort and test results</p></li></ul><p>Arne, how does that work for you?</p>