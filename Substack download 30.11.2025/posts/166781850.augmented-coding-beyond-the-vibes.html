<p><em>I recently came to a good stopping spot on an ambitious project to build a B+ Tree library using  augmented coding. The result is <a href="https://github.com/KentBeck/BPlusTree3">BPlusTree3</a> - a performance-competitive, maybe-production-ready implementation in Rust &amp; Python. I sat down with a friend to tell my story and reflect on what it reveals about the future of programming in the GenAI era.</em></p><blockquote><p>If you want to support my work, join a community working together on a variety of interesting projects, &amp; get early access to my hot-off-the-press thoughts about how our profession is changing, please consider paying for a subscription. </p><p class="button-wrapper" data-attrs="{&quot;url&quot;:&quot;https://tidyfirst.substack.com/subscribe?&quot;,&quot;text&quot;:&quot;Subscribe now&quot;,&quot;action&quot;:null,&quot;class&quot;:null}" data-component-name="ButtonCreateButton"><a class="button primary" href="https://tidyfirst.substack.com/subscribe?"><span>Subscribe now</span></a></p></blockquote><p><strong>What drew you to implement a B+ Tree in the first place?</strong></p><p>When I started to realize the incredible power of augmented coding I began recalling projects from my past that had been out of my reach technically. One of those was a special purpose database. In implementing that database project now I realized that I didn't understand the B+ Tree data structure well enough so I switched targets.</p><p><strong>What does "augmented coding" mean to you in practice?</strong></p><p>This was about the same time as I realized that "augmented coding" was different than "vibe coding", that I was exploring an entirely new space of programming workflow. So I reduced the scope of the project to just the B+ Tree instead of a whole database, but at the same time increased the scope to see if augmented coding could create production-ready, performance-competitive library code. I also wanted to learn Rust. So yeah it was complicated.</p><p><strong>Can you explain the distinction between "augmented coding" and "vibe coding"?</strong></p><p>In vibe coding you don't care about the code, just the behavior of the system. If there's an error, you feed it back into the genie in hopes of a good enough fix. In augmented coding you care about the code, its complexity, the tests, &amp; their coverage. The value system in augmented coding is similar to hand coding--tidy code that works. It's just that I don't type much of that code.</p><p><strong>When you decided to tackle the B+ Tree project, what was your starting point?</strong></p><p>You can see from the first commits that I was trying to get the genie to use TDD. You'll also see that the repo is called BPlusTree3. My first 2 attempts had accumulated so much complexity that the genie completely stalled. That's why I intruded more on the design &amp; tried to keep the genie from coding ahead.</p><p><strong>What did "intruding more on the design" look like in practice?</strong></p><p>I'll add my system prompt as an appendix. I watched the intermediate results of the genie more carefully, ready to intervene &amp; stop unproductive development. I would look at the code &amp; propose "for the next test add the keys in the reverse order". Then I'd look at the genie's work to see if it had done what I had asked.</p><p><strong>What were the warning signs that told you the AI was going off track?</strong></p><ol><li><p>Loops. </p></li><li><p>Functionality I hadn't asked for (even if it was a reasonable next step).</p></li><li><p>Any indication that the genie was cheating, for example by disabling or deleting tests.</p></li></ol><p><strong>How did the final result turn out?</strong></p><p>I feel good about the correctness &amp; performance, not so good about the code quality. When I try to write the code as a literate program there's just too much accidental complexity. I'm still working on getting the genie to care as much as I do about simplicity.</p><p>One delightful aspect of augmented coding is that I had the genie write performance benchmarks to compare my Rust BPlusTreeMap to the Rust's BTreeMap and my Python BPlusTreeMap to Python's Sorted Dict. In both cases my code is a bit slower at some operations but faster at range scanning (iterating through a list of keys).</p><p>I should tell you about the Python version. That was a surprise.</p><p><strong>What was surprising about the Python version?</strong></p><p>I got a certain ways with the Rust code &amp; the genie got stuck in complexity, in particular the compounding complexity of the data structure itself interacting with Rust's memory ownership model. Rather than give up &amp; move to version 4 I decided to try a risky experiment.</p><p>I had the genie write a version for Python. Same tests, just a new, less constraining language. I got the algorithm fairly solid. Then I told the genie to erase the Rust code &amp; just transliterate the Python code into Rust. I had just gotten access to Augment's Remote Agent [disclosure: Augment has been a newsletter sponsor]. I sent the rewrite off to some remote computer somewhere &amp; what came back (with little interaction from me) was acceptable.</p><p>That unstuck the genie. Now we had Python code that worked but was slow &amp; Rust code that mostly worked &amp; was fast. That's when the genie suggested that if I wanted a performance-competitive Python library I would need to write a C extension. My shoulders slumped--that sounds like a lot of work &amp; learning.</p><p>ðŸ’¡ But I don't have to do the work! Hey genie, write a C extension. Chug chug chug. Here you go. And it's nearly as fast as Python's built-in data structure.</p><p><strong>Looking back at this journey, what does this teach us about augmented coding?</strong></p><p>I know there's a lot of fear out there about the end of this profession that we love, the loss of the joy of wrangling code. Makes sense to be nervous. Yes programming changes with a genie, but it's still programming. In some ways a much better programming experience. I make more consequential programming decisions per hour, fewer boring vanilla decisions.</p><p>Yak shaving mostly goes away. I had the genie run a coverage tester &amp; propose tests that would make the code more reliable. Without the genie this would have been a daunting task--what versions of what libraries do I need to run the coverage tester? Two hours later I'd just give up. Instead, I tell the genie &amp; it figures out the details.</p><h2>Appendix 1: System Prompt</h2><p>Always follow the instructions in plan.md. When I say "go", find the next unmarked test in plan.md, implement the test, then implement only enough code to make that test pass.</p><p># ROLE AND EXPERTISE</p><p>You are a senior software engineer who follows Kent Beck's Test-Driven Development (TDD) and Tidy First principles. Your purpose is to guide development following these methodologies precisely.</p><p># CORE DEVELOPMENT PRINCIPLES</p><p>- Always follow the TDD cycle: Red â†’ Green â†’ Refactor</p><p>- Write the simplest failing test first </p><p>- Implement the minimum code needed to make tests pass</p><p>- Refactor only after tests are passing</p><p>- Follow Beck's "Tidy First" approach by separating structural changes from behavioral changes</p><p>- Maintain high code quality throughout development</p><p># TDD METHODOLOGY GUIDANCE</p><p>- Start by writing a failing test that defines a small increment of functionality</p><p>- Use meaningful test names that describe behavior (e.g., "shouldSumTwoPositiveNumbers")</p><p>- Make test failures clear and informative</p><p>- Write just enough code to make the test pass - no more</p><p>- Once tests pass, consider if refactoring is needed</p><p>- Repeat the cycle for new functionality</p><p># TIDY FIRST APPROACH</p><p>- Separate all changes into two distinct types:</p><p>  1. STRUCTURAL CHANGES: Rearranging code without changing behavior (renaming, extracting methods, moving code)</p><p>  2. BEHAVIORAL CHANGES: Adding or modifying actual functionality</p><p>- Never mix structural and behavioral changes in the same commit</p><p>- Always make structural changes first when both are needed</p><p>- Validate structural changes do not alter behavior by running tests before and after</p><p># COMMIT DISCIPLINE</p><p>- Only commit when:</p><p>  1. ALL tests are passing</p><p>  2. ALL compiler/linter warnings have been resolved</p><p>  3. The change represents a single logical unit of work</p><p>  4. Commit messages clearly state whether the commit contains structural or behavioral changes</p><p>- Use small, frequent commits rather than large, infrequent ones</p><p># CODE QUALITY STANDARDS</p><p>- Eliminate duplication ruthlessly</p><p>- Express intent clearly through naming and structure</p><p>- Make dependencies explicit</p><p>- Keep methods small and focused on a single responsibility</p><p>- Minimize state and side effects</p><p>- Use the simplest solution that could possibly work</p><p># REFACTORING GUIDELINES</p><p>- Refactor only when tests are passing (in the "Green" phase)</p><p>- Use established refactoring patterns with their proper names</p><p>- Make one refactoring change at a time</p><p>- Run tests after each refactoring step</p><p>- Prioritize refactorings that remove duplication or improve clarity</p><p># EXAMPLE WORKFLOW</p><p>When approaching a new feature:</p><p>1. Write a simple failing test for a small part of the feature</p><p>2. Implement the bare minimum to make it pass</p><p>3. Run tests to confirm they pass (Green)</p><p>4. Make any necessary structural changes (Tidy First), running tests after each change</p><p>5. Commit structural changes separately</p><p>6. Add another test for the next small increment of functionality</p><p>7. Repeat until the feature is complete, committing behavioral changes separately from structural ones</p><p>Follow this process precisely, always prioritizing clean, well-tested code over quick implementation.</p><p>Always write one test at a time, make it run, then improve structure. Always run all the tests (except long-running tests) each time.</p><p># Rust-specific</p><p>Prefer functional programming style over imperative style in Rust. Use Option and Result combinators (map, and_then, unwrap_or, etc.) instead of pattern matching with if let or match when possible.</p><h2>Appendix 2: Time Spent</h2><p>I spent about 4 weeks on this project, much of it while I was traveling and/or recovering from a concussion. Iâ€™m sure one of you kids could speed run this in far fewer development hours, but for context hereâ€™s the time I spent:</p><div class="captioned-image-container"><figure><a class="image-link image2 is-viewable-img" target="_blank" href="https://substackcdn.com/image/fetch/$s_!9AVy!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F588ca4a9-1872-4202-aea1-d7005ada1bf5_535x428.png" data-component-name="Image2ToDOM"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!9AVy!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F588ca4a9-1872-4202-aea1-d7005ada1bf5_535x428.png 424w, https://substackcdn.com/image/fetch/$s_!9AVy!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F588ca4a9-1872-4202-aea1-d7005ada1bf5_535x428.png 848w, https://substackcdn.com/image/fetch/$s_!9AVy!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F588ca4a9-1872-4202-aea1-d7005ada1bf5_535x428.png 1272w, https://substackcdn.com/image/fetch/$s_!9AVy!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F588ca4a9-1872-4202-aea1-d7005ada1bf5_535x428.png 1456w" sizes="100vw"><img src="https://substack-post-media.s3.amazonaws.com/public/images/588ca4a9-1872-4202-aea1-d7005ada1bf5_535x428.png" width="535" height="428" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/588ca4a9-1872-4202-aea1-d7005ada1bf5_535x428.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:428,&quot;width&quot;:535,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:53749,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:&quot;https://tidyfirst.substack.com/i/166781850?img=https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F588ca4a9-1872-4202-aea1-d7005ada1bf5_535x428.png&quot;,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" class="sizing-normal" alt="" srcset="https://substackcdn.com/image/fetch/$s_!9AVy!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F588ca4a9-1872-4202-aea1-d7005ada1bf5_535x428.png 424w, https://substackcdn.com/image/fetch/$s_!9AVy!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F588ca4a9-1872-4202-aea1-d7005ada1bf5_535x428.png 848w, https://substackcdn.com/image/fetch/$s_!9AVy!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F588ca4a9-1872-4202-aea1-d7005ada1bf5_535x428.png 1272w, https://substackcdn.com/image/fetch/$s_!9AVy!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F588ca4a9-1872-4202-aea1-d7005ada1bf5_535x428.png 1456w" sizes="100vw" loading="lazy"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></button><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2 lucide-maximize-2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></button></div></div></div></a></figure></div><p>I kept to a fairly steady pace of commits per hour:</p><div class="captioned-image-container"><figure><a class="image-link image2 is-viewable-img" target="_blank" href="https://substackcdn.com/image/fetch/$s_!Lwjp!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcf871925-f944-4199-ae72-b42e3dd0afdb_406x467.png" data-component-name="Image2ToDOM"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!Lwjp!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcf871925-f944-4199-ae72-b42e3dd0afdb_406x467.png 424w, https://substackcdn.com/image/fetch/$s_!Lwjp!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcf871925-f944-4199-ae72-b42e3dd0afdb_406x467.png 848w, https://substackcdn.com/image/fetch/$s_!Lwjp!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcf871925-f944-4199-ae72-b42e3dd0afdb_406x467.png 1272w, https://substackcdn.com/image/fetch/$s_!Lwjp!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcf871925-f944-4199-ae72-b42e3dd0afdb_406x467.png 1456w" sizes="100vw"><img src="https://substack-post-media.s3.amazonaws.com/public/images/cf871925-f944-4199-ae72-b42e3dd0afdb_406x467.png" width="406" height="467" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/cf871925-f944-4199-ae72-b42e3dd0afdb_406x467.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:467,&quot;width&quot;:406,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:44835,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:&quot;https://tidyfirst.substack.com/i/166781850?img=https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcf871925-f944-4199-ae72-b42e3dd0afdb_406x467.png&quot;,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" class="sizing-normal" alt="" srcset="https://substackcdn.com/image/fetch/$s_!Lwjp!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcf871925-f944-4199-ae72-b42e3dd0afdb_406x467.png 424w, https://substackcdn.com/image/fetch/$s_!Lwjp!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcf871925-f944-4199-ae72-b42e3dd0afdb_406x467.png 848w, https://substackcdn.com/image/fetch/$s_!Lwjp!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcf871925-f944-4199-ae72-b42e3dd0afdb_406x467.png 1272w, https://substackcdn.com/image/fetch/$s_!Lwjp!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcf871925-f944-4199-ae72-b42e3dd0afdb_406x467.png 1456w" sizes="100vw" loading="lazy"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></button><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2 lucide-maximize-2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></button></div></div></div></a></figure></div><p>Yes, I programmed 13 hours one day. This stuff is ADDICTIVE!</p><p>Also, the genie is happy to do the above kind of analysis when youâ€™re ready to reflect on your work.</p>