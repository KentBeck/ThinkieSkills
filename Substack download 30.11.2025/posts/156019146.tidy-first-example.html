<p>The examples are always the hardest part. I keep saying that, but then when I see an example I brush right past it. Well, this time I caught one.</p><p>You may have heard this one:</p><div class="pullquote"><p>For each hard change,<br>make the change easy<br>(warning, this may be hard),<br>then make the easy change.</p></div><p>People read that and say, “Oh, yeah. I’d love that, only making easy changes.” But then, in the moment, the lure of just making the change beckons. How hard can this really be? I’ll tidy later.</p><p>And by “people”, I mean “me”.</p><p>Here’s one I encountered when re-launching my person web site, <a href="https://kentbeck.com">KentBeck.com</a>.</p><p>I’m using a cookie-less analytics package called Fathom. So far I’m pretty happy with it but then I’m not diving deeply into the analytics. The way you track a page is by putting a script in the head section of your HTML:</p><p><code>    &lt;script src="https://cdn.usefathom.com/script.js" data-site="WHATEVER" defer&gt;&lt;/script&gt;</code></p><p>This has the side effect of setting a global variable (← coupling warning) <code>fathom</code> to an object that will provide the API for future analytics recording. It also has the side effect of recording the current visit.</p><p>So far, so good. My site has many facets, reflecting the mirrorball properties of my mind.</p><div class="captioned-image-container"><figure><a class="image-link image2 is-viewable-img" target="_blank" href="https://substackcdn.com/image/fetch/$s_!QUQU!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ee9ebe4-aecc-4d80-8116-a1fd9b9524f7_504x638.png" data-component-name="Image2ToDOM"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!QUQU!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ee9ebe4-aecc-4d80-8116-a1fd9b9524f7_504x638.png 424w, https://substackcdn.com/image/fetch/$s_!QUQU!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ee9ebe4-aecc-4d80-8116-a1fd9b9524f7_504x638.png 848w, https://substackcdn.com/image/fetch/$s_!QUQU!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ee9ebe4-aecc-4d80-8116-a1fd9b9524f7_504x638.png 1272w, https://substackcdn.com/image/fetch/$s_!QUQU!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ee9ebe4-aecc-4d80-8116-a1fd9b9524f7_504x638.png 1456w" sizes="100vw"><img src="https://substack-post-media.s3.amazonaws.com/public/images/8ee9ebe4-aecc-4d80-8116-a1fd9b9524f7_504x638.png" width="504" height="638" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/8ee9ebe4-aecc-4d80-8116-a1fd9b9524f7_504x638.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:638,&quot;width&quot;:504,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:154523,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" class="sizing-normal" alt="" srcset="https://substackcdn.com/image/fetch/$s_!QUQU!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ee9ebe4-aecc-4d80-8116-a1fd9b9524f7_504x638.png 424w, https://substackcdn.com/image/fetch/$s_!QUQU!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ee9ebe4-aecc-4d80-8116-a1fd9b9524f7_504x638.png 848w, https://substackcdn.com/image/fetch/$s_!QUQU!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ee9ebe4-aecc-4d80-8116-a1fd9b9524f7_504x638.png 1272w, https://substackcdn.com/image/fetch/$s_!QUQU!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ee9ebe4-aecc-4d80-8116-a1fd9b9524f7_504x638.png 1456w" sizes="100vw" loading="lazy"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></button><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2 lucide-maximize-2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></button></div></div></div></a></figure></div><p>When someone clicks on a topic, they see an essay about it below. (And yes the design is, as a friend pointed out, “homespun”. At least it’s done &amp; out there.)</p><p>Here’s the code to handle &amp; record a topic click:</p><p><code>function handleTopicClick(event) {<br>    const topics = document.querySelectorAll('.topic');<br>    topics.forEach(t =&gt; t.classList.remove('active'));<br>    event.target.classList.add('active');<br>    const topicId = event.target.dataset.topic;<br>    fathom.trackEvent(`Topic clicked: ${topicId}`);<br>    updateContent(topicId);<br>}</code></p><h2>But Blockers</h2><p>What happens, though, when someone blocks analytics? That original call to load the analytics script fails, the variable <code>fathom</code> never gets set, the call to <code>trackEvent</code> fails, &amp; the content never gets updated.</p><p>We can fix that:</p><p><code>    if (typeof fathom !== 'undefined') {<br>        fathom.trackEvent(`Topic clicked: ${topicId}`);<br>    }</code></p><p>But should we? This is exactly the Tidy First? moment. The “make the change easy, then make the easy change” moment.</p><p>First, if we want to get a fix out there, sure, add the if statement. If the cost of delay is high, don’t delay.</p><p>Second, though, we have a chance to fool-proof the API. Before we load the analytics script, we can set the global variable <code>fathom</code> to a Null Object:</p><p><code>&lt;script&gt;<br>    fathom = { trackEvent: function() {} };<br>&lt;/script&gt;<br>&lt;script src="https://cdn.usefathom.com/script.js" data-site="WHATEVER" defer&gt;&lt;/script&gt;</code></p><p>Now we don’t need (and if necessary, can remove) the conditional. Not only that, but every other call to <code>fathom.trackEvent</code> is automatically safe.</p><h2>Further Work</h2><p>This little baby Null Object is not done. We might want to:</p><ul><li><p>Replicate the whole Fathom API to make sure all the calls are safe.</p></li><li><p>Log elsewhere that analytics didn’t load, too make sure we’re not missing too much data.</p></li><li><p>Write our own analytics API where Fathom provides the underlying implementation at the moment. This is particularly attractive if it turns out that we repeat the same parameters to calls all over the place (potential coupling!).</p></li></ul><p>It’s the moment I wanted to capture &amp; point out. I wanted to add an if statement, &amp; add it in a way that I would have to remember to add it every time I used analytics in the future. Instead I tidied first, I made the change easy (in this case made the change unnecessary).</p><h2>Appendix: Topic Data</h2><p>In case you were wondering, here’s how the topics are stacking up:</p><ul><li><p>software-design 128% (not fair, this is the default)</p></li><li><p>thinkies 28%</p></li><li><p>art 23%</p></li><li><p>poker 22%</p></li><li><p>speaking 22%</p></li><li><p>consulting 21%</p></li><li><p>music 20%</p></li></ul><p>I don’t yet have a way to see if some people just click all the topics or if different people choose different subsets.</p>