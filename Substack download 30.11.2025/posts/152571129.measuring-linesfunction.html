<p>Measuring the lines per function for the recent chapter on Pareto distributions in software turned out to be trickier than expected. I’ve done similar enough times that I figured I’d document it for you all as you look for your own distributions. (And I hope you do go look for your own distributions.)</p><p>If I’ve made gross mistakes in what follows or there are simpler solutions to </p><h2>Code</h2><p>I just downloaded JUnit 5. May as well start with something I know well. Knew well.</p><h2>Raw Lines</h2><p>There isn’t a tool I’ve found that just spits the data we need. However, there are code metrics tools we can bend to our will. One I’ve used in the past is pmd https://pmd.github.io/pmd/index.html. It’s a lint-like tool for checking rules.</p><p>We have to trick pmd into spitting a warning for every function, so we create a custom rule based on Ncss (non-comment source statements). We set the threshold to 1 so every function fails. We put the following into lines.xml:</p><p><code>&lt;?xml version="1.0"?&gt;<br>&lt;ruleset name="Custom Rules"&gt;<br>  &lt;description&gt;<br>    My custom rules<br>  &lt;/description&gt;<br>  &lt;rule ref="category/java/design.xml/NcssCount"&gt;<br>    &lt;properties&gt;<br>      &lt;property name="methodReportLevel" value="1" /&gt;<br>      &lt;property name="classReportLevel" value="10000000" /&gt;<br>      &lt;property name="ncssOptions" value="" /&gt;<br>    &lt;/properties&gt;<br>  &lt;/rule&gt;<br>&lt;/ruleset&gt;</code></p><p>Now we can run it in the root directory of JUnit:</p><p><code>pmd check -R lines.xml -d .</code></p><h2>Extract Lines</h2><p>We get some errors &amp; a bunch of lines like this:</p><p><code>./platform-tooling-support-tests/src/main/java/platform/tooling/support/Helper.java:117: NcssCount: The method 'getJavaHome(String)' has a NCSS line count of 3.</code></p><p>We’ll use awk to turn them into numbers:</p><p><code>pmd check -R lines.xml -d . | awk -F'NCSS line count of ' '{print $2}'</code></p><p>Now sort -n to sort them numerically (because we want to plot the values in numerical order) followed by uniq -c (-c counts occurrences) to turn them into a histogram.</p><p><code>pmd check -R lines.xml -d . | awk -F'NCSS line count of ' '{print $2}' | sort -n | uniq -c</code></p><p><code>1436 1.<br>5491 2.<br>…</code></p><h2>Conclusion</h2><p>Copy these x’s and y’s into a spreadsheet. Graph them on an x-y plot. </p><div class="captioned-image-container"><figure><a class="image-link image2 is-viewable-img" target="_blank" href="https://substackcdn.com/image/fetch/$s_!PSy6!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc38b6503-502a-4658-8637-eac87b7ccc0a_846x612.png" data-component-name="Image2ToDOM"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!PSy6!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc38b6503-502a-4658-8637-eac87b7ccc0a_846x612.png 424w, https://substackcdn.com/image/fetch/$s_!PSy6!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc38b6503-502a-4658-8637-eac87b7ccc0a_846x612.png 848w, https://substackcdn.com/image/fetch/$s_!PSy6!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc38b6503-502a-4658-8637-eac87b7ccc0a_846x612.png 1272w, https://substackcdn.com/image/fetch/$s_!PSy6!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc38b6503-502a-4658-8637-eac87b7ccc0a_846x612.png 1456w" sizes="100vw"><img src="https://substack-post-media.s3.amazonaws.com/public/images/c38b6503-502a-4658-8637-eac87b7ccc0a_846x612.png" width="846" height="612" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/c38b6503-502a-4658-8637-eac87b7ccc0a_846x612.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:612,&quot;width&quot;:846,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:32254,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" class="sizing-normal" alt="" srcset="https://substackcdn.com/image/fetch/$s_!PSy6!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc38b6503-502a-4658-8637-eac87b7ccc0a_846x612.png 424w, https://substackcdn.com/image/fetch/$s_!PSy6!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc38b6503-502a-4658-8637-eac87b7ccc0a_846x612.png 848w, https://substackcdn.com/image/fetch/$s_!PSy6!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc38b6503-502a-4658-8637-eac87b7ccc0a_846x612.png 1272w, https://substackcdn.com/image/fetch/$s_!PSy6!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc38b6503-502a-4658-8637-eac87b7ccc0a_846x612.png 1456w" sizes="100vw" loading="lazy"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></button><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2 lucide-maximize-2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></button></div></div></div></a></figure></div><p>Switch both axes to logarithmic.</p><div class="captioned-image-container"><figure><a class="image-link image2 is-viewable-img" target="_blank" href="https://substackcdn.com/image/fetch/$s_!KVCU!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3640493e-14eb-4612-94f9-68d3b682beb4_862x612.png" data-component-name="Image2ToDOM"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!KVCU!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3640493e-14eb-4612-94f9-68d3b682beb4_862x612.png 424w, https://substackcdn.com/image/fetch/$s_!KVCU!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3640493e-14eb-4612-94f9-68d3b682beb4_862x612.png 848w, https://substackcdn.com/image/fetch/$s_!KVCU!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3640493e-14eb-4612-94f9-68d3b682beb4_862x612.png 1272w, https://substackcdn.com/image/fetch/$s_!KVCU!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3640493e-14eb-4612-94f9-68d3b682beb4_862x612.png 1456w" sizes="100vw"><img src="https://substack-post-media.s3.amazonaws.com/public/images/3640493e-14eb-4612-94f9-68d3b682beb4_862x612.png" width="862" height="612" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/3640493e-14eb-4612-94f9-68d3b682beb4_862x612.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:612,&quot;width&quot;:862,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:34667,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" class="sizing-normal" alt="" srcset="https://substackcdn.com/image/fetch/$s_!KVCU!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3640493e-14eb-4612-94f9-68d3b682beb4_862x612.png 424w, https://substackcdn.com/image/fetch/$s_!KVCU!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3640493e-14eb-4612-94f9-68d3b682beb4_862x612.png 848w, https://substackcdn.com/image/fetch/$s_!KVCU!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3640493e-14eb-4612-94f9-68d3b682beb4_862x612.png 1272w, https://substackcdn.com/image/fetch/$s_!KVCU!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3640493e-14eb-4612-94f9-68d3b682beb4_862x612.png 1456w" sizes="100vw" loading="lazy"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></button><button tabindex="0" type="button" class="pencraft pc-reset pencraft icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2 lucide-maximize-2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></button></div></div></div></a></figure></div><p>And done!</p><p></p>